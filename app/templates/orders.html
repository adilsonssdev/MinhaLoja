{% extends "base.html" %}

{% block title %}
Orders - MiniLoja
{% endblock %}

{% block content %}
<div class="py-5">
	<h2 class="mb-4 fw-bold">My Orders</h2>

	<!-- Alerts -->
	{% with msgs = get_flashed_messages(with_categories=True) %}
	{% if msgs %}
	{% for c, msg in msgs %}
	<div class="alert alert-{{ 'danger' if c == 'error' else 'success' }} alert-dismissible fade show" role="alert">
		{{ msg | safe }}
		<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
	</div>
	{% endfor %}
	{% endif %}
	{% endwith %}

	{% if not orders %}
	<div class="text-center py-5 bg-white rounded-3 shadow-sm">
		<i class="fa fa-box-open fa-3x text-muted mb-3"></i>
		<h3>No orders yet</h3>
		<p class="text-muted">You haven't placed any orders yet.</p>
		<a href="{{ url_for('home') }}" class="btn btn-primary mt-2">Start Shopping</a>
	</div>
	{% else %}
	<div class="bg-white rounded-3 shadow-sm overflow-hidden">
		<div class="table-responsive">
			<table class="table table-hover mb-0">
				<thead class="bg-light">
					<tr>
						<th class="py-3 ps-4">Order ID</th>
						<th class="py-3">Date</th>
						<th class="py-3">Items</th>
						<th class="py-3 text-end pe-4">Status</th>
					</tr>
				</thead>
				<tbody>
					{% for order in orders %}
					<tr>
						<td class="ps-4 fw-medium">#{{ order.id }}</td>
						<td>{{ order.date.strftime('%Y-%m-%d') }} <span class="text-muted small">{{
								order.date.strftime('%H:%M') }}</span></td>
						<td>
							{% for i in order.items %}
							<div>
								{{ i.item.name }} <span class="badge bg-secondary rounded-pill ms-1">x{{ i.quantity
									}}</span>
							</div>
							{% endfor %}
						</td>
						<td class="text-end pe-4">
							<span class="badge bg-{{ 'success' if order.status == 'Completed' else 'warning' }}">{{
								order.status }}</span>
						</td>
					</tr>
					{% endfor %}
				</tbody>
			</table>
		</div>
	</div>
	{% endif %}
</div>
{% endblock %}